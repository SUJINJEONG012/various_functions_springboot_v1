<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="admin/layout/basic">
<th:block layout:fragment="title">
	<title>관리자 슥서 리스트 페이지</title>
</th:block>

<th:block layout:fragment="content">

	<div class="content">

		<section>
			<table class="tb tb_col">
				<colgroup>
					<col style="width: auto;" />
					<col style="width: auto;" />
					<col style="width: auto;" />
					<col style="width: auto;" />
					<col style="width: auto;" />
					<col style="width: auto;" />
					<col style="width: 30%;" />
				</colgroup>

				<thead>
					<tr>
						<th scope="col">번호</th>
						<th scope="col">카테고리</th>
						<th scope="col">이름</th>
						<th scope="col">주소</th>
						<th scope="col">휴대폰번호</th>
						<th scope="col">성급</th>
						<th scope="col">객실가격</th>
						<th scope="col">객실타입</th>
						<th>이미지</th>

					</tr>
				</thead>

				<tbody th:each="accommodation : ${accommodations}">
					<tr>
						<td th:text="${accommodation.accommodationId}"></td>
						<td th:text="${accommodation.accommodationCate}"></td>
						<td th:text="${accommodation.accommodationName}"></td>
						<td th:text="${accommodation.accommodationAdress}"></td>
						<td th:text="${accommodation.accommodationPhone}"></td>
						<td th:text="${accommodation.accommodationGrade}"></td>

						<td th:each="room : ${accommodation.rooms}"
							th:text="${#numbers.formatInteger(room.roomPeak,0,'COMMA') + '원'}"></td>
						<td th:each="room : ${accommodation.rooms}"
							th:text="${room.roomRoomtype} + '등급'"></td>

						<!-- <td
							th:each="accommodationsFiles : ${accommodation.accommodationsFiles}">
							
						</td> -->
						
						 <td>
							<span id="files"></span>
						</td>


					</tr>

				</tbody>


			</table>
		</section>

	</div>

</th:block>
<th:block layout:fragment="script">
	<script th:inline="javascript">
		/*<![CDATA[*/
			window.onload = ()=>{
				findAllFile();
			}
			function findAllFile(){
			
				const accommodationId = [[ ${accommodation.accommodationId}]];
				const response = getJson(`/admin/accommodation/${accommodationId}/files`);
				
				if(!response.length){
					return false;
				}
				
				let fileHtml = '<div class="file_down"><div class="cont">';
				response.forEach(row =>{
					if(row.originalName.match(/\.(jpeg|jpg|gif|png)$/) != null){ // 이미지 파일체크
						 fileHtml += `
						<img src="/admin/accommodation/${accommodationId}/files/${row.afId}/list" alt="${row.originalName}" style="width: 100%; height: auto;" >
							`
					}
					//여기서 else{}추가해도됨.
					/* fileHtml += `
						<a href="/admin/accommodation/${accommodationId}/files/${row.afId}/download">
						<span class="icons">
						<i class="fas fa-folder-open"></i></span>${row.originalName}
						</a>

					` */
				});
				fileHtml += '</div></div>';
				document.getElementById('files').innerHTML = fileHtml;
			}
			

		/*]]>*/
	</script>
</th:block>
</html>