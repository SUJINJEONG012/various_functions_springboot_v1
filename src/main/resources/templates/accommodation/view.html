<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="/layout/basic">
<th:block layout:fragment="title">
	<title>글 상세페이지</title>
	
</th:block>


<th:block layout:fragment="content">
<!--
상단에 이미지 노출 
숙소이름  노출 
좌측에는 예약하기 금액 노출 박스로 
숙소소개 관련 글 

숙소위치는 지도로 노출
리뷰는나중에 노출하기 위해서 일단 보류

  -->
<style>
	.calendar-container {
	    display: flex;
	    justify-content: space-between;
	    width: 80%;
	    margin-top: 20px;
	}
	
	.calendar {
	    background-color: white;
	    border: 1px solid #ddd;
	    border-radius: 8px;
	    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	    overflow: hidden;
	    width: 300px;
	    text-align: center;
	}
	
	.calendar header {
	    background-color: #007BFF;
	    color: white;
	    text-align: center;
	    padding: 10px;
	}
	
	.calendar table {
	    width: 100%;
	    border-collapse: collapse;
	}
	
	.calendar th, .calendar td {
	    padding: 10px;
	    text-align: center;
	}
	
	.calendar th {
	    background-color: #f4f4f4;
	}
	
	.calendar td {
	    cursor: pointer;
	}
	
	.calendar .today {
	    background-color: #007BFF;
	    color: white;
	    border-radius: 50%;
	}
	
	.calendar .selected {
	    background-color: #28a745;
	    color: white;
	    border-radius: 50%;
	}
	
	#selected-dates {
	    margin-top: 20px;
	}
	
	button {
	    background-color: #007BFF;
	    color: white;
	    border: none;
	    padding: 10px;
	    cursor: pointer;
	}
	
	button:hover {
	    background-color: #0056b3;
	}
	
	#month-year, #month-year-checkout {
	    margin: 10px 0;
	}
	
</style>  
<div class="content">
	<h4>숙소리스트 </h4>
		
	<!-- 달력 -->
	<div class="calendar-container">
	        <div class="calendar">
	            <button id="prev-month">&lt;</button>
	            <div id="month-year"></div>
	            <button id="next-month">&gt;</button>
	            <div id="calendar"></div>
	        </div>
	        <div class="calendar">
	            <button id="prev-month-checkout">&lt;</button>
	            <div id="month-year-checkout"></div>
	            <button id="next-month-checkout">&gt;</button>
	            <div id="calendar-checkout"></div>
	        </div>
	    </div>
	    <div id="selected-dates">
	        <p>Check-in: <span id="checkin-date">None</span></p>
	        <p>Check-out: <span id="checkout-date">None</span></p>
	    </div>
	   
		<!-- 숙소 이미지 출력 -->
		<div class="row row-cols-1 row-cols-md-3 mb-3 text-center">
		  
			<div class="col">
		    <div class="card mb-4 rounded-3 shadow-sm">
		      <div class="card-header py-3">
		        <h4 th:text="${accommodation.accommodationName}"></h4>
		      </div>
		      <div class="card-body">
		        
		        <h1 class="card-title">
		        
		        <div th:each="room : ${accommodation.rooms}">
		        	<span th:utext="${room.RoomPeak} + '<span>원</span>' "></span>
		        </div>
				</h1>
				
				<!-- 
				이미지 주석처리하면에러안나오고 이미지부분에서 에러니옴-->
				<div id="files" th:each="file : ${files}">
					<img th:src="@{'/accommodation/' + ${accommodation.accommodationId} + '/files/' + ${file.afId} + '/list'}"
					alt="File Image" style="width: 50%;">
				</div> 
				
				

				<ul class=" mt-3 mb-4">
					<li th:text="${accommodation.accommodationCate}"></li>
					<li th:text="${accommodation.accommodationGrade + '등급'}"></li>
					<li th:text="${accommodation.accommodationDetail}"></li>
		        </ul>
				
		       <div>예약하기ㅇㅇㅇ</div>
		        
		      </div>
		    </div>
		  </div>
		  
		</div>
</div>
		
  
  
</th:block>
<th:block layout:fragment="script">
	<script th:inline="javascript">
		/*<![CDATA[*/
				window.onload = () => {
				//deleteNotice();
				findAllFile();
			}
			
		// 파일조회	
		function findAllFile(){
			
			const accommodationId = [[${accommodation.accommodationId}]];
			const response = getJson(`/accommodation/${accommodationId}/files`);
			
			if(!response.length){
				return false;
			}
			
			let fileHtml = '<div class="file_down"><div class="cont">';
			response.forEach(row => {
				if(row.originalName.match(/\.(jpeg|jpg|gif|png)$/) != null){
				fileHtml += `
					<img src="/accommodation/${accommodationId}/files/${row.afId}/view" alt="${row.originalName}" style="width: 100%; height: auto;">
				`
			}
				
			
			});
			fileHtml += '</div></div>';
			
			document.getElementById('files').innerHTML = fileHtml;
			
		}	
		
		// 달력
		document.addEventListener("DOMContentLoaded", function() {
		    const calendarElement = document.getElementById('calendar');
		    const monthYearElement = document.getElementById('month-year');
		    const prevMonthButton = document.getElementById('prev-month');
		    const nextMonthButton = document.getElementById('next-month');
		
		    const calendarCheckoutElement = document.getElementById('calendar-checkout');
		    const monthYearCheckoutElement = document.getElementById('month-year-checkout');
		    const prevMonthCheckoutButton = document.getElementById('prev-month-checkout');
		    const nextMonthCheckoutButton = document.getElementById('next-month-checkout');
		
		    const checkinDateDisplay = document.getElementById('checkin-date');
		    const checkoutDateDisplay = document.getElementById('checkout-date');
		
		    let checkinDate = null;
		    let checkoutDate = null;
		
		    let currentCheckinMonth = new Date().getMonth();
		    let currentCheckinYear = new Date().getFullYear();
		    let currentCheckoutMonth = new Date().getMonth();
		    let currentCheckoutYear = new Date().getFullYear();
		
		    const renderCalendar = (calendarElement, monthYearElement, currentMonth, currentYear, isCheckin) => {
		        const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
		        const lastDateOfMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
		        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
		        
		        monthYearElement.textContent = `${monthNames[currentMonth]} ${currentYear}`;
		        
		        let calendarHTML = '<table><tr>';
		        const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
		        for (let day of daysOfWeek) {
		            calendarHTML += `<th>${day}</th>`;
		        }
		        calendarHTML += '</tr><tr>';
		        
		        for (let i = 0; i < firstDayOfMonth; i++) {
		            calendarHTML += '<td></td>';
		        }
		        
		        for (let date = 1; date <= lastDateOfMonth; date++) {
		            if ((firstDayOfMonth + date - 1) % 7 === 0 && date > 1) {
		                calendarHTML += '</tr><tr>';
		            }
		            const dateString = `${currentYear}-${currentMonth + 1}-${date}`;
		            calendarHTML += `<td class="date-cell" data-date="${dateString}">${date}</td>`;
		        }
		        calendarHTML += '</tr></table>';
		        
		        calendarElement.innerHTML = calendarHTML;
		        
		        document.querySelectorAll('.date-cell').forEach(cell => {
		            cell.addEventListener('click', (e) => {
		                const selectedDate = e.target.getAttribute('data-date');
		                if (isCheckin) {
		                    checkinDate = selectedDate;
		                    checkinDateDisplay.textContent = checkinDate;
		                } else {
		                    checkoutDate = selectedDate;
		                    checkoutDateDisplay.textContent = checkoutDate;
		                }
		                e.target.classList.add('selected');
		            });
		        });
		    };
		
		    renderCalendar(calendarElement, monthYearElement, currentCheckinMonth, currentCheckinYear, true);
		    renderCalendar(calendarCheckoutElement, monthYearCheckoutElement, currentCheckoutMonth, currentCheckoutYear, false);
		
		    prevMonthButton.addEventListener('click', () => {
		        if (currentCheckinMonth === 0) {
		            currentCheckinMonth = 11;
		            currentCheckinYear -= 1;
		        } else {
		            currentCheckinMonth -= 1;
		        }
		        renderCalendar(calendarElement, monthYearElement, currentCheckinMonth, currentCheckinYear, true);
		    });
		
		    nextMonthButton.addEventListener('click', () => {
		        if (currentCheckinMonth === 11) {
		            currentCheckinMonth = 0;
		            currentCheckinYear += 1;
		        } else {
		            currentCheckinMonth += 1;
		        }
		        renderCalendar(calendarElement, monthYearElement, currentCheckinMonth, currentCheckinYear, true);
		    });
		
		    prevMonthCheckoutButton.addEventListener('click', () => {
		        if (currentCheckoutMonth === 0) {
		            currentCheckoutMonth = 11;
		            currentCheckoutYear -= 1;
		        } else {
		            currentCheckoutMonth -= 1;
		        }
		        renderCalendar(calendarCheckoutElement, monthYearCheckoutElement, currentCheckoutMonth, currentCheckoutYear, false);
		    });
		
		    nextMonthCheckoutButton.addEventListener('click', () => {
		        if (currentCheckoutMonth === 11) {
		            currentCheckoutMonth = 0;
		            currentCheckoutYear += 1;
		        } else {
		            currentCheckoutMonth += 1;
		        }
		        renderCalendar(calendarCheckoutElement, monthYearCheckoutElement, currentCheckoutMonth, currentCheckoutYear, false);
		    });
		});

		
		
		/*]]>*/
	</script>
	
	
</th:block>
</html>